/*! videojs-chromecast - v0.1.0 - 2017-01-10*/
!function(a,b){"use strict";function c(a){this.isConnected_=!1,this.onSessionJoined_=a}c.prototype={connect_:function(){var a=new this.cast.SessionRequest(this.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID),b=new this.cast.ApiConfig(a,this.onSessionJoined_,this.receiverListener_.bind(this));this.cast.initialize(b,this.onInitSuccess_,this.onInitError_)},initialize_:function(){this.isAvailable?(this.connect_(),this.intializeTimeout_=void 0):this.intializeTimeout_=setTimeout(this.initialize_.bind(this),2e3)},receiverListener_:function(a){"available"===a&&(this.isConnected_=!0)},initialize:function(b,c){!this.isConnected_&&a.chrome&&(this.onInitSuccess_=b,this.onInitError_=c,this.initialize_())},dispose:function(){this.intializeTimeout_&&clearTimeout(this.intializeTimeout_)}},Object.defineProperties(c.prototype,{cast:{get:function(){return a.chrome?a.chrome.cast:void 0}},isConnected:{get:function(){return this.isConnected_}},isAvailable:{get:function(){return this.cast&&this.cast.isAvailable}}}),b.plugin("chromecast",function(a){var d=b.getComponent("Chromecast"),e=this,f={dispose:e.dispose,src:e.src};this.initCastConnection_=function(){!this.castConnection_&&this.canCastCurrentSrc_()&&(this.castConnection_=new c(this.onCastSessionJoined_),this.castConnection_.initialize_(this.onCastInitSucccess_,this.onCastInitError))},this.onCastInitSucccess_=function(){this.trigger("chromecast-initialized")},this.onCastInitError_=function(){this.trigger("chromecast-error",{code:"LAUNCH_ERROR"})},this.onCastSessionJoined_=function(a){a.media.length&&(this.castSession_=a,this.onCastMediaLoaded_(this.castSession_.media[0]))},this.onCastSessionUpdate_=function(a){if(!a)return this.onCastStopped_("chromecast-stopped")},this.onCastMediaLoaded_=function(a){this.options_.chromecast={apiMedia:a,apiSession:this.castSession_,currentTime:this.currentTime()},this.loadTech_("Chromecast",this.currentSource()),this.castName_=this.castSession_.receiver.friendlyName,this.castSession_.addUpdateListener(this.onCastSessionUpdate_.bind(this)),this.trigger("chromecast-media-loaded")},this.onCastStopped_=function(a,b){if(this.castSession_){var c=this.currentSource(),d=this.currentTime();this.castSession_=void 0,this.unloadTech_(),delete this.options_.chromecast,this.trigger("waiting"),this.src([c]),this.starttime&&this.starttime(d),this.one("ready",function(){this.starttime||this.one("timeupdate",function(){this.currentTime(d)}),this.play()}),this.trigger(a,b)}},this.onLaunchSuccess_=function(a){var b=this.currentSource(),c=this.castConnection_.cast,d=new c.media.MediaInfo(b.src,b.type),e=new c.media.LoadRequest(d);e.autoplay=!0,e.currentTime=this.currentTime(),this.castSession_=a,this.pause(),this.trigger("waiting"),this.castSession_.loadMedia(e,this.onCastMediaLoaded_.bind(this),function(){this.trigger("chromecast-error",{code:"MEDIA_ERROR"})}.bind(this))},this.launchCasting=function(){if(this.castConnection_&&this.castConnection_.isConnected){var a=this.castConnection_.cast;this.pause(),this.trigger("waiting"),a.requestSession(this.onLaunchSuccess_.bind(this),function(){this.pause(),this.trigger("chromecast-error",{code:"MEDIA_ERROR"})}.bind(this))}},this.stopCasting=function(){this.castSession_&&this.castSession_.stop(this.onCastStopped_.bind(this,"chromecast-stopped"),this.onCastStopped_.bind(this,"chromecast-error",{code:"STOP_ERROR"}))},this.getCastDeviceName=function(){return this.castName_},this.isCasting=function(){return!!this.castSession_},this.canCastCurrentSrc_=function(){var a=d.canPlaySource(this.currentSource());return"maybe"===a||"probably"===a},this.isCastReady=function(){return this.canCastCurrentSrc_()&&this.castConnection_&&this.castConnection_.isConnected},this.disposeCast_=function(){this.stopCasting(),this.castConnection_&&(this.castConnection_.dispose(),this.castConnection_=void 0)},this.dispose=function(){this.disposeCast_(),f.dispose.call(this)},this.src=function(a){return a&&this.stopCasting(),f.src.call(this,a)},this.isReady_?this.initCastConnection_():this.on("ready",function(){this.initCastConnection_()})})}(window,window.videojs),function(a,b,c){"use strict";var d=b.getComponent("Component"),e=b.getTech("Tech"),f=a.chrome,g=b.extend(e,{constructor:function(a,b){e.prototype.constructor.apply(this,arguments),this.apiMedia_=this.options_.apiMedia,this.apiSession_=this.options_.apiSession,this.currentTime_=this.options_.currentTime,this.paused_=!1,this.muted_=!1,this.apiMedia_.addUpdateListener(this.onMediaStateUpdate_.bind(this)),this.apiSession_.addUpdateListener(this.onSessionUpdate_.bind(this)),this.startProgressTimer_(),this.triggerReady(),this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("loadeddata"),this.trigger("canplay"),this.trigger("canplaythrough"),this.trigger("durationchange")},onSessionUpdate_:function(a){this.apiMedia_&&!a&&this.stopCasting_()},stopCasting_:function(){this.stopTrackingCurrentTime(),clearInterval(this.progressTimer_),this.apiMedia_.stop(),this.apiSession_.stop()},onMediaStateUpdate_:function(){if(this.apiMedia_)switch(this.currentTime_=this.apiMedia_.currentTime,this.apiMedia_.playerState){case f.cast.media.PlayerState.BUFFERING:this.trigger("waiting");break;case f.cast.media.PlayerState.IDLE:this.onIdle_();break;case f.cast.media.PlayerState.PAUSED:this.trigger("pause"),this.paused_=!0;break;case f.cast.media.PlayerState.PLAYING:this.trigger("playing"),this.trigger("play"),this.paused_=!1}},onIdle_:function(){if(this.apiMedia_){switch(this.apiMedia_.idleReason){case f.cast.media.IdleReason.CANCELLED:case f.cast.media.IdleReason.INTERRUPTED:case f.cast.media.IdleReason.ERROR:this.trigger("error");break;case f.cast.media.IdleReason.FINISHED:this.ended_=!0,this.trigger("ended")}this.stopCasting_()}},src:function(a){},currentSrc:function(){return this.options_.source},seekable:function(){},mediaCastError_:function(a){},mediaCastSuccess_:function(){},apiCall_:function(a,b){this.apiMedia_[a](b||null,this.mediaCastSuccess_.bind(this),this.mediaCastError_.bind(this))},play:function(){this.apiMedia_&&(this.paused_&&this.apiCall_("play"),this.paused_=!1)},pause:function(){this.apiMedia_&&(this.paused_||(this.apiCall_("pause"),this.paused_=!0))},paused:function(){return this.paused_},currentTime:function(){return this.ended_?this.duration():this.currentTime_},setCurrentTime:function(a){if(this.apiMedia_){var b=new f.cast.media.SeekRequest;b.currentTime=a,this.currentTime_=a,this.apiCall_("seek",b)}},startProgressTimer_:function(){this.progressTimer_&&clearInterval(this.progressTimer_),this.progressTimer_=setInterval(this.incrementCurrentTime_.bind(this),1e3)},incrementCurrentTime_:function(){this.apiMedia_&&this.apiMedia_.playerState===f.cast.media.PlayerState.PLAYING&&(this.currentTime()<this.apiMedia_.media.duration?(this.currentTime_+=1,this.trigger("timeupdate")):clearInterval(this.progressTime_))},onSeekSuccess:function(a){},ended:function(){return this.ended_||this.duration()<=this.currentTime_},duration:function(){return this.apiMedia_?this.apiMedia_.media.duration:0},controls:function(){return!1},volume:function(){return this.volume_},setVolume:function(a){if(this.apiMedia_){var b=new f.cast.Volume,c=new f.cast.media.VolumeRequest;this.mediaCastSuccess_.bind(this,"Volume changed"),this.mediaCastError_.bind(this);b.level=a,this.volume_=a,c.volume=b,this.apiCall_("setVolume",c),this.trigger("volumechange")}},muted:function(){return this.muted_},setMuted:function(a){if(this.apiMedia_){var b=new f.cast.Volume,c=new f.cast.media.VolumeRequest;this.mediaCastSuccess_.bind(this,"Mute changed"),this.mediaCastError_.bind(this);this.muted_=void 0!==a&&!!a,b.level=this.muted_,this.apiCall_("setVolume",c),this.trigger("volumechange")}},supportsFullScreen:function(){return!1},resetSrc_:function(a){a()},supportsStarttime:function(){return!1},dispose:function(){this.stopCasting_(),this.apiMedia_=void 0,this.apiSession_=void 0,this.resetSrc_(Function.prototype),e.prototype.dispose.apply(this,arguments)}});g.prototype.options_={},g.isSupported=function(){return!0},g.prototype.featuresVolumeControl=!0,g.prototype.featuresPlaybackRate=!1,g.prototype.movingMediaElementInDOM=!1,g.prototype.featuresFullscreenResize=!1,g.prototype.featuresTimeupdateEvents=!1,g.prototype.featuresProgressEvents=!1,g.prototype.featuresNativeTextTracks=!0,g.prototype.featuresNativeAudioTracks=!0,g.prototype.featuresNativeVideoTracks=!1,g.supportsCasting_=function(a){var b=/^application\/(?:dash\+xml|(x-|vnd\.apple\.)mpegurl)/i,c=/^video\/(mpd|mp4|webm|m3u8)/i;return b.test(a)?"probably":c.test(a)?"maybe":""},g.canPlaySource=function(a){return f&&a.type?this.supportsCasting_(a.type):this.supportsCasting_(a.src)},d.registerComponent("Chromecast",g),e.registerTech("Chromecast",g)}(window,window.videojs,document);