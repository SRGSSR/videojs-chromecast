/*! videojs-chromecast - v0.1.0 - 2016-12-13*/
!function(a,b,c,d){"use strict";var e=b.getComponent("Component"),f=b.getTech("Tech"),g=a.chrome,h=b.extend(f,{constructor:function(a,b){f.prototype.constructor.apply(this,arguments),this.apiMedia=this.options_.source.apiMedia,this.apiSession=this.options_.source.apiSession,this.currentMediaTime=this.options_.source.currentTime,this.receiver=this.apiSession.receiver.friendlyName,this.apiMedia.addUpdateListener(this.onMediaStatusUpdate.bind(this)),this.apiSession.addUpdateListener(this.onSessionUpdate.bind(this)),this.startProgressTimer(this.incrementMediaTime.bind(this));var c=this.textTracks();c&&function(){var a=this.handleTracksChange.bind(this);c.addEventListener("change",a),this.on("dispose",function(){c.removeEventListener("change",a)}),this.handleTracksChange()}.bind(this)(),this.triggerReady(),this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("loadeddata"),this.trigger("canplay"),this.trigger("canplaythrough"),this.trigger("durationchange")},onSessionUpdate:function(a){if(this.apiMedia)return a?void 0:this.onStopAppSuccess()},onStopAppSuccess:function(){this.stopTrackingCurrentTime(),clearInterval(this.timer),this.apiMedia.stop(),this.apiSession.stop()},onIdle:function(){if(this.apiMedia){switch(this.apiMedia.idleReason){case g.cast.media.IdleReason.CANCELLED:case g.cast.media.IdleReason.INTERRUPTED:case g.cast.media.IdleReason.ERROR:this.trigger("error");break;case g.cast.media.IdleReason.FINISHED:this._ended=!0,this.trigger("ended")}this.onStopAppSuccess()}},onMediaStatusUpdate:function(){if(this.apiMedia)switch(this.currentMediaTime=this.apiMedia.currentTime,this.apiMedia.playerState){case g.cast.media.PlayerState.BUFFERING:this.trigger("waiting");break;case g.cast.media.PlayerState.IDLE:this.onIdle();break;case g.cast.media.PlayerState.PAUSED:this.trigger("pause"),this.paused_=!0;break;case g.cast.media.PlayerState.PLAYING:this.trigger("playing"),this.trigger("play"),this.paused_=!1}},src:function(a){},currentSrc:function(){return this.options_.source.src},seekable:function(){return d},handleTracksChange:function(){var a=[],b=this.textTracks();if(b){for(var c=0;c<b.length;c++){var d=b[c];"showing"===d.mode&&a.push(c+1)}return this.apiMedia?(this.tracksInfoRequest=new g.cast.media.EditTracksInfoRequest(a),this.apiMedia.editTracksInfo(this.tracksInfoRequest,this.onTrackSuccess.bind(this),this.onTrackError.bind(this))):void 0}},onTrackSuccess:function(a){},onTrackError:function(a){},castError:function(a){},play:function(){this.apiMedia&&(this.paused_&&this.apiMedia.play(null,this.mediaCommandSuccessCallback.bind(this,"Playing: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!1)},pause:function(){this.apiMedia&&(this.paused_||(this.apiMedia.pause(null,this.mediaCommandSuccessCallback.bind(this,"Paused: "+this.apiMedia.sessionId),this.castError.bind(this)),this.paused_=!0))},paused:function(){return this.paused_},currentTime:function(){return this._ended?this.duration():this.currentMediaTime},setCurrentTime:function(a){if(!this.apiMedia)return 0;var b=new g.cast.media.SeekRequest;return b.currentTime=a,this.currentMediaTime=a,this.apiMedia.seek(b,this.onSeekSuccess.bind(this,a),this.castError.bind(this))},startProgressTimer:function(a){this.timer&&(clearInterval(this.timer),this.timer=null),this.timer=setInterval(a.bind(this),this.timerStep)},incrementMediaTime:function(){this.apiMedia.playerState===g.cast.media.PlayerState.PLAYING&&(this.currentTime()<this.apiMedia.media.duration?(this.currentMediaTime+=1,this.trigger("timeupdate")):clearInterval(this.timer))},onSeekSuccess:function(a){},volume:function(){return this.volume_},ended:function(){return this._ended||this.duration()<=this.currentMediaTime},duration:function(){return this.apiMedia?this.apiMedia.media.duration:0},controls:function(){return!1},setVolume:function(a){var b,c,e=!(arguments.length<=1||arguments[1]===d)&&arguments[1];if(this.apiMedia)return c=new g.cast.Volume,c.level=a,c.muted=e,this.volume_=c.level,this.muted_=e,b=new g.cast.media.VolumeRequest,b.volume=c,this.apiMedia.setVolume(b,this.mediaCommandSuccessCallback.bind(this,"Volume changed"),this.castError.bind(this)),this.trigger("volumechange")},mediaCommandSuccessCallback:function(a){},muted:function(){return this.muted_},setMuted:function(a){return this.setVolume(this.volume_,a)},supportsFullScreen:function(){return!1},resetSrc_:function(a){a()},dispose:function(){this.onStopAppSuccess(),this.apiMedia=d,this.apiSession=d,this.resetSrc_(Function.prototype),f.prototype.dispose.apply(this,arguments)}});h.prototype.paused_=!1,h.prototype.options_={},h.prototype.timerStep=1e3,h.isSupported=function(){return!0},h.prototype.featuresVolumeControl=!0,h.prototype.featuresPlaybackRate=!1,h.prototype.movingMediaElementInDOM=!1,h.prototype.featuresFullscreenResize=!1,h.prototype.featuresTimeupdateEvents=!1,h.prototype.featuresProgressEvents=!1,h.prototype.featuresNativeTextTracks=!0,h.prototype.featuresNativeAudioTracks=!0,h.prototype.featuresNativeVideoTracks=!1,h.supportsCasting=function(a){var b=/^application\/(?:dash\+xml|(x-|vnd\.apple\.)mpegurl)/i,c=/^video\/(mpd|mp4|webm|m3u8)/i;return b.test(a)?"probably":c.test(a)?"maybe":""},h.canPlaySource=function(a){return g&&a.type?this.supportsCasting(a.type):this.supportsCasting(a.src)},e.registerComponent("Chromecast",h),f.registerTech("Chromecast",h)}(window,window.videojs,document);